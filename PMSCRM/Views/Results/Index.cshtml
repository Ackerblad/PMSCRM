@model PMSCRM.ViewModels.SearchResultsViewModel

@{
    ViewData["Title"] = "Search Results";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h3 class="fw-bold fs-4 mb-3">Search Results</h3>

@if (Model != null)
{
    // Display Areas
    if (Model.Areas.Any())
    {
        <h4 class="mt-4">Area List</h4>
        <table class="table table-striped table-hover">
            <thead class="table-dark">
                <tr>
                    <th>
                        <a asp-action="SortResults" asp-route-sortBy="Name" 
                        asp-route-sortDirection="@((ViewBag.CurrentSort == "Name" && ViewBag.CurrentSortDirection == "asc")
                        ? "desc" : "asc")" class="text-light">
                        Name
                            @if (ViewBag.CurrentSort == "Name")
                            {
                                <span>@(ViewBag.CurrentSortDirection == "asc" ? "▲" : "▼")</span>
                            }
                            else
                            {
                                <span>▲</span> <!-- Default arrow for ascending -->
                            }
                    </a>
                       @*  <button type="submit" name="sortBy" value="Name" class="btn btn-link">
                            Area Name
                            @if (ViewBag.CurrentSort == "Name")
                            {
                                <span>@(ViewBag.CurrentSortDirection == "asc" ? "▲" : "▼")</span>
                            }
                        </button> *@
                    </th>
                    <th>
                        <button type="submit" name="sortBy" value="Description" class="btn btn-link">
                            Description
                            @if (ViewBag.CurrentSort == "Description")
                            {
                                <span>@(ViewBag.CurrentSortDirection == "asc" ? "▲" : "▼")</span>
                            }
                        </button>
                    </th>
                </tr>
            </thead>
            <tbody>
                @foreach (var area in Model.Areas)
                {
                    <tr>
                        <td>@area.Name</td>
                        <td>@area.Description</td>
@*                         <td class="text-end">
                            <a href="/Area/EditArea/@area.AreaId" class="btn btn-primary btn-sm custom">Edit</a>
                            <a href="/Area/DeleteArea/@area.AreaId" class="btn btn-danger btn-sm custom">Delete</a>
                        </td> *@
                    </tr>
                }
            </tbody>
        </table>
    }
    else if (Model.FilterArray.Contains("Area"))
    {
        <p>No areas found.</p>
    }

    // Display Customers
    if (Model.Customers.Any())
    {
        <h4 class="mt-4">Customer List</h4>
        <table class="table table-striped table-hover">
            <thead class="table-dark">
                <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Street</th>
                    <th>City</th>
                    <th>State</th>
                    <th>Postal</th>
                    <th>Country</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var customer in Model.Customers)
                {
                    <tr>
                        <td>@customer.Name</td>
                        <td>@customer.EmailAddress</td>
                        <td>@customer.StreetAddress</td>
                        <td>@customer.City</td>
                        <td>@customer.StateOrProvince</td>
                        <td>@customer.PostalCode</td>
                        <td>@customer.Country</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else if (Model.FilterArray.Contains("Customer"))
    {
        <p>No customers found.</p>
    }

    // Display Processes
    if (Model.Processes.Any())
    {
        <h4 class="mt-4">Process List</h4>
        <table class="table table-striped table-hover">
            <thead class="table-dark">
                <tr>
                    <th>Name</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var process in Model.Processes)
                {
                    <tr>
                        <td>@process.Name</td>
                        <td>@process.Description</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else if (Model.FilterArray.Contains("Process"))
    {
        <p>No processes found.</p>
    }

    // Display Tasks
    if (Model.Tasks.Any())
    {
        <h4 class="mt-4">Task List</h4>
        <table class="table table-striped table-hover">
            <thead class="table-dark">
                <tr>
                    <th>Name</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var task in Model.Tasks)
                {
                    <tr>
                        <td>@task.Name</td>
                        <td>@task.Description</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else if (Model.FilterArray.Contains("Task"))
    {
        <p>No tasks found.</p>
    }

    // Display Users
    if (Model.Users.Any())
    {
        <h4 class="mt-4">User List</h4>
        <table class="table table-striped table-hover">
            <thead class="table-dark">
                <tr>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Email Address</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var user in Model.Users)
                {
                    <tr>
                        <td>@user.FirstName</td>
                        <td>@user.LastName</td>
                        <td>@user.EmailAddress</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else if (Model.FilterArray.Contains("User"))
    {
        <p>No users found.</p>
    }
}
else
{
    <p>No results found.</p>
}

@* <a asp-action="Index" class="btn btn-success">New Search</a> *@

<script>
    $(function () {
        $('[data-bs-toggle="tooltip"]').tooltip();
    });
</script>

<style>
    .custom {
        width: 78px !important;
    }
</style>
